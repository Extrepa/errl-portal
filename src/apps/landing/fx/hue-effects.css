/**
 * CSS Hue Rotation Effects
 * Fallback and complementary hue controls for non-WebGL elements
 */

/* CSS Custom Properties for hue control */
:root {
  --errl-hue-shift: 0deg;
  --errl-hue-intensity: 100%;
  --errl-saturation: 100%;
}

/* Animated hue cycling classes */
.hue-cycle-slow {
  animation: hue-rotate-cycle 30s linear infinite;
}

.hue-cycle-medium {
  animation: hue-rotate-cycle 15s linear infinite;
}

.hue-cycle-fast {
  animation: hue-rotate-cycle 8s linear infinite;
}

.hue-cycle-pulse {
  animation: hue-pulse 4s ease-in-out infinite;
}

/* If an element is being controlled by the hue controller, only animate when enabled.
   Otherwise the animation would force a filter even when hue is toggled off. */
.hue-controlled.hue-cycle-slow,
.hue-controlled.hue-cycle-medium,
.hue-controlled.hue-cycle-fast,
.hue-controlled.hue-cycle-pulse {
  animation: none;
}
.hue-controlled.hue-enabled.hue-cycle-slow {
  animation: hue-rotate-cycle 30s linear infinite;
}
.hue-controlled.hue-enabled.hue-cycle-medium {
  animation: hue-rotate-cycle 15s linear infinite;
}
.hue-controlled.hue-enabled.hue-cycle-fast {
  animation: hue-rotate-cycle 8s linear infinite;
}
.hue-controlled.hue-enabled.hue-cycle-pulse {
  animation: hue-pulse 4s ease-in-out infinite;
}

/* Base hue rotation utility
   Use a class toggle + CSS variables so other animations (bubble shine, hover)
   don't clobber hue by writing `filter:`. */
.hue-controlled {
  filter: none;
}
.hue-controlled.hue-enabled {
  filter:
    hue-rotate(var(--errlHueDeg, 0deg))
    saturate(var(--errlHueSatPct, 100%))
    brightness(var(--errlHueBrightPct, 100%));
}

/* Apply to background layer with hue shift */
.l0.hue-controlled {
  filter: none;
}

/* Motes with hue effects */
.mote.hue-controlled {
  filter: none;
}

/* HUD bubbles with subtle hue */
.hud .bubble.hue-controlled {
  filter: none;
}

/* Navigation buttons with hue */
.btn.hue-controlled::before {
  filter: none;
}

/* Errl character hue (when not using WebGL) */
.errl.hue-controlled {
  filter: none;
}

/* Ripple effects hue */
.portal-drip.hue-controlled {
  filter: none;
}

/* Keyframes */
@keyframes hue-rotate-cycle {
  0% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 0deg))
      saturate(var(--errlHueSatPct, var(--errl-saturation, 100%)))
      brightness(var(--errlHueBrightPct, 100%));
  }
  25% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 90deg))
      saturate(calc(var(--errlHueSatPct, var(--errl-saturation, 100%)) + 10%))
      brightness(calc(var(--errlHueBrightPct, 100%) + 5%));
  }
  50% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 180deg))
      saturate(calc(var(--errlHueSatPct, var(--errl-saturation, 100%)) + 20%))
      brightness(calc(var(--errlHueBrightPct, 100%) + 8%));
  }
  75% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 270deg))
      saturate(calc(var(--errlHueSatPct, var(--errl-saturation, 100%)) + 10%))
      brightness(calc(var(--errlHueBrightPct, 100%) + 5%));
  }
  100% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 360deg))
      saturate(var(--errlHueSatPct, var(--errl-saturation, 100%)))
      brightness(var(--errlHueBrightPct, 100%));
  }
}

@keyframes hue-pulse {
  0%, 100% { 
    filter:
      hue-rotate(var(--errlHueDeg, var(--errl-hue-shift, 0deg)))
      saturate(var(--errlHueSatPct, var(--errl-saturation, 100%)))
      brightness(var(--errlHueBrightPct, 100%));
  }
  50% { 
    filter:
      hue-rotate(calc(var(--errlHueDeg, var(--errl-hue-shift, 0deg)) + 60deg))
      saturate(calc(var(--errlHueSatPct, var(--errl-saturation, 100%)) + 30%))
      brightness(calc(var(--errlHueBrightPct, 100%) + 10%));
  }
}

/* Smooth transitions */
.hue-controlled {
  transition: filter 0.3s ease;
}

/* Performance optimizations */
.hue-controlled {
  will-change: filter;
  transform: translateZ(0); /* Force GPU acceleration */
}

/* Color theme variants based on hue */
.theme-warm {
  --errl-hue-shift: 30deg;
  --errl-saturation: 110%;
}

.theme-cool {
  --errl-hue-shift: 180deg;  
  --errl-saturation: 105%;
}

.theme-electric {
  --errl-hue-shift: 270deg;
  --errl-saturation: 130%;
}

.theme-sunset {
  --errl-hue-shift: 15deg;
  --errl-saturation: 125%;
}

.theme-ocean {
  --errl-hue-shift: 200deg;
  --errl-saturation: 115%;
}

.theme-forest {
  --errl-hue-shift: 120deg;
  --errl-saturation: 110%;
}